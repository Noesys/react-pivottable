{"version":3,"sources":["src/TableRenderers.jsx"],"names":["spanSize","arr","i","j","x","asc","end","noDraw","len","length","asc1","end1","stop","redColorScaleGenerator","values","min","Math","apply","max","nonRed","round","backgroundColor","makeRenderer","opts","TableRenderer","pivotData","props","colAttrs","cols","rowAttrs","rows","rowKeys","getRowKeys","colKeys","getColKeys","grandTotalAggregator","getAggregator","hideRowTotal","hideColTotal","valueCellColors","rowTotalColors","colTotalColors","heatmapMode","colorScaleGenerator","tableColorScaleGenerator","rowTotalValues","map","value","colTotalValues","allValues","push","r","c","colorScale","v","rowColorScales","rowValues","colColorScales","colValues","fontFamily","fontSize","fontWeight","fontLabelWeight","fontStyle","fontLabelStyle","colKey","display","rowKey","totalAggregator","getAllMeasures","vals","filter","d","totalFormattingIndex","findRow","getIndex","getElement","includes","element","indexOf","txt","aggregator","findCol","merge","fontDataWeight","fontDataStyle","color","ValueFontColor","valueFormatter","format","totalfontColor","PureComponent","defaultProps","propTypes","func","TSVExportRenderer","headerRow","aggregatorName","join","result","row","unshift","width","window","innerWidth","height","innerHeight","Table"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;;;AAEA;AACA,IAAMA,WAAW,SAAXA,QAAW,CAAUC,GAAV,EAAeC,CAAf,EAAkBC,CAAlB,EAAqB;AACpC,MAAIC,UAAJ;AACA,MAAIF,MAAM,CAAV,EAAa;AACX,QAAIG,YAAJ;AAAA,QAASC,YAAT;AACA,QAAIC,SAAS,IAAb;AACA,SACEH,IAAI,CAAJ,EAAOE,MAAMH,CAAb,EAAgBE,MAAMC,OAAO,CAD/B,EAEED,MAAMD,KAAKE,GAAX,GAAiBF,KAAKE,GAFxB,EAGED,MAAMD,GAAN,GAAYA,GAHd,EAIE;AACA,UAAIH,IAAIC,IAAI,CAAR,EAAWE,CAAX,MAAkBH,IAAIC,CAAJ,EAAOE,CAAP,CAAtB,EAAiC;AAC/BG,iBAAS,KAAT;AACD;AACF;AACD,QAAIA,MAAJ,EAAY;AACV,aAAO,CAAC,CAAR;AACD;AACF;AACD,MAAIC,MAAM,CAAV;AACA,SAAON,IAAIM,GAAJ,GAAUP,IAAIQ,MAArB,EAA6B;AAC3B,QAAIC,aAAJ;AAAA,QAAUC,aAAV;AACA,QAAIC,OAAO,KAAX;AACA,SACER,IAAI,CAAJ,EAAOO,OAAOR,CAAd,EAAiBO,OAAOC,QAAQ,CADlC,EAEED,OAAON,KAAKO,IAAZ,GAAmBP,KAAKO,IAF1B,EAGED,OAAON,GAAP,GAAaA,GAHf,EAIE;AACA,UAAIH,IAAIC,CAAJ,EAAOE,CAAP,MAAcH,IAAIC,IAAIM,GAAR,EAAaJ,CAAb,CAAlB,EAAmC;AACjCQ,eAAO,IAAP;AACD;AACF;AACD,QAAIA,IAAJ,EAAU;AACR;AACD;AACDJ;AACD;AACD,SAAOA,GAAP;AACD,CArCD;;AAuCA,SAASK,sBAAT,CAAgCC,MAAhC,EAAwC;AACtC,MAAMC,MAAMC,KAAKD,GAAL,CAASE,KAAT,CAAeD,IAAf,EAAqBF,MAArB,CAAZ;AACA,MAAMI,MAAMF,KAAKE,GAAL,CAASD,KAAT,CAAeD,IAAf,EAAqBF,MAArB,CAAZ;AACA,SAAO,aAAK;AACV;AACA,QAAMK,SAAS,MAAMH,KAAKI,KAAL,CAAW,OAAOhB,IAAIW,GAAX,KAAmBG,MAAMH,GAAzB,CAAX,CAArB;AACA,WAAO,EAAEM,8BAA4BF,MAA5B,SAAsCA,MAAtC,MAAF,EAAP;AACD,GAJD;AAKD;;AAED,SAASG,YAAT,GAAiC;AAAA,MAAXC,IAAW,uEAAJ,EAAI;;AAAA,MACzBC,aADyB;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,+BAEpB;AACP,YAAMC,YAAY,yBAAc,KAAKC,KAAnB,CAAlB;AACA,YAAMC,WAAWF,UAAUC,KAAV,CAAgBE,IAAjC;AACA,YAAMC,WAAWJ,UAAUC,KAAV,CAAgBI,IAAjC;AACA,YAAMC,UAAUN,UAAUO,UAAV,EAAhB;AACA,YAAMC,UAAUR,UAAUS,UAAV,EAAhB;AACA,YAAMC,uBAAuBV,UAAUW,aAAV,CAAwB,EAAxB,EAA4B,EAA5B,CAA7B;;AAEA,YAAIC,eAAgBZ,UAAUC,KAAV,CAAgBW,YAAjB,GAAiC,MAAjC,GAA0C,YAA7D;AACA,YAAIC,eAAgBb,UAAUC,KAAV,CAAgBY,YAAjB,GAAiC,MAAjC,GAA0C,YAA7D;;AAEA,YAAIC,kBAAkB,2BAAM,CAAG,CAA/B;AACA,YAAIC,iBAAiB,0BAAM,CAAG,CAA9B;AACA,YAAIC,iBAAiB,0BAAM,CAAG,CAA9B;AACA,YAAIlB,KAAKmB,WAAT,EAAsB;AACpB,cAAMC,sBAAsB,KAAKjB,KAAL,CAAWkB,wBAAvC;AACA,cAAMC,iBAAiBZ,QAAQa,GAAR,CAAY;AAAA,mBACjCrB,UAAUW,aAAV,CAAwB,EAAxB,EAA4BhC,CAA5B,EAA+B2C,KAA/B,EADiC;AAAA,WAAZ,CAAvB;AAGAP,2BAAiBG,oBAAoBE,cAApB,CAAjB;AACA,cAAMG,iBAAiBjB,QAAQe,GAAR,CAAY;AAAA,mBACjCrB,UAAUW,aAAV,CAAwBhC,CAAxB,EAA2B,EAA3B,EAA+B2C,KAA/B,EADiC;AAAA,WAAZ,CAAvB;AAGAN,2BAAiBE,oBAAoBK,cAApB,CAAjB;;AAEA,cAAIzB,KAAKmB,WAAL,KAAqB,MAAzB,EAAiC;AAC/B,gBAAMO,YAAY,EAAlB;AACAlB,oBAAQe,GAAR,CAAY;AAAA,qBACVb,QAAQa,GAAR,CAAY;AAAA,uBACVG,UAAUC,IAAV,CAAezB,UAAUW,aAAV,CAAwBe,CAAxB,EAA2BC,CAA3B,EAA8BL,KAA9B,EAAf,CADU;AAAA,eAAZ,CADU;AAAA,aAAZ;AAKA,gBAAMM,aAAaV,oBAAoBM,SAApB,CAAnB;AACAV,8BAAkB,yBAACY,CAAD,EAAIC,CAAJ,EAAOE,CAAP;AAAA,qBAAaD,WAAWC,CAAX,CAAb;AAAA,aAAlB;AACD,WATD,MASO,IAAI/B,KAAKmB,WAAL,KAAqB,KAAzB,EAAgC;AACrC,gBAAMa,iBAAiB,EAAvB;AACAxB,oBAAQe,GAAR,CAAY,aAAK;AACf,kBAAMU,YAAYvB,QAAQa,GAAR,CAAY;AAAA,uBAC5BrB,UAAUW,aAAV,CAAwBe,CAAxB,EAA2B/C,CAA3B,EAA8B2C,KAA9B,EAD4B;AAAA,eAAZ,CAAlB;AAGAQ,6BAAeJ,CAAf,IAAoBR,oBAAoBa,SAApB,CAApB;AACD,aALD;AAMAjB,8BAAkB,yBAACY,CAAD,EAAIC,CAAJ,EAAOE,CAAP;AAAA,qBAAaC,eAAeJ,CAAf,EAAkBG,CAAlB,CAAb;AAAA,aAAlB;AACD,WATM,MASA,IAAI/B,KAAKmB,WAAL,KAAqB,KAAzB,EAAgC;AACrC,gBAAMe,iBAAiB,EAAvB;AACAxB,oBAAQa,GAAR,CAAY,aAAK;AACf,kBAAMY,YAAY3B,QAAQe,GAAR,CAAY;AAAA,uBAC5BrB,UAAUW,aAAV,CAAwBhC,CAAxB,EAA2BgD,CAA3B,EAA8BL,KAA9B,EAD4B;AAAA,eAAZ,CAAlB;AAGAU,6BAAeL,CAAf,IAAoBT,oBAAoBe,SAApB,CAApB;AACD,aALD;AAMAnB,8BAAkB,yBAACY,CAAD,EAAIC,CAAJ,EAAOE,CAAP;AAAA,qBAAaG,eAAeL,CAAf,EAAkBE,CAAlB,CAAb;AAAA,aAAlB;AACD;AACF;;AAED,eACE;AAAA;AAAA,YAAO,WAAU,UAAjB;AACE,mBAAO;AACLK,0BAAYlC,UAAUC,KAAV,CAAgBiC,UADvB,EACmCC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B;AADxE,aADT;AAIE;AAAA;AAAA;AACGjC,qBAASmB,GAAT,CAAa,UAAUM,CAAV,EAAajD,CAAb,EAAgB;AAC5B,qBACE;AAAA;AAAA,kBAAI,iBAAeA,CAAnB;AACGA,sBAAM,CAAN,IACC0B,SAASpB,MAAT,KAAoB,CADrB,IAEG,sCAAI,OAAO,EAAEY,iBAAiBI,UAAUC,KAAV,CAAgBL,eAAnC,EAAX,EAAiE,SAASQ,SAASpB,MAAnF,EAA2F,SAASkB,SAASlB,MAA7G,GAHN;AAKE;AAAA;AAAA,oBAAI,WAAU,cAAd,EAA6B,OAAO;AAClCY,uCAAiBI,UAAUC,KAAV,CAAgBL,eADC,EACgBuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADrD;AAElCC,kCAAYpC,UAAUC,KAAV,CAAgBoC,eAFM,EAEWC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFtC,qBAApC;AAGIZ;AAHJ,iBALF;AASGnB,wBAAQa,GAAR,CAAY,UAAUmB,MAAV,EAAkB/D,CAAlB,EAAqB;AAChC,sBAAME,IAAIJ,SAASiC,OAAT,EAAkB/B,CAAlB,EAAqBC,CAArB,CAAV;AACA,sBAAIC,MAAM,CAAC,CAAX,EAAc;AACZ,2BAAO,IAAP;AACD;AACD,yBACE;AAAA;AAAA;AACE,iCAAU,aADZ;AAEE,6BAAO;AACLiB,yCAAiBI,UAAUC,KAAV,CAAgBL,eAD5B,EAC6CuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADlF;AAELC,oCAAYpC,UAAUC,KAAV,CAAgBoC,eAFvB,EAEwCC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFnE,uBAFT;AAME,sCAAc9D,CANhB;AAOE,+BAASE,CAPX;AAQE,+BACED,MAAMwB,SAASlB,MAAT,GAAkB,CAAxB,IAA6BoB,SAASpB,MAAT,KAAoB,CAAjD,GACI,CADJ,GAEI;AAXR;AAcGwD,2BAAO9D,CAAP;AAdH,mBADF;AAkBD,iBAvBA,CATH;AAkCGA,sBAAM,CAAN,IACC;AAAA;AAAA;AACE,+BAAU,eADZ;AAEE,2BAAO;AACLkB,uCAAiBI,UAAUC,KAAV,CAAgBL,eAD5B,EAC6CuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADlF;AAELC,kCAAYpC,UAAUC,KAAV,CAAgBoC,eAFvB,EAEwCC,WAAWtC,UAAUC,KAAV,CAAgBsC,cAFnE,EAEmFE,SAAS7B;AAF5F,qBAFT;AAME,6BACEV,SAASlB,MAAT,IAAmBoB,SAASpB,MAAT,KAAoB,CAApB,GAAwB,CAAxB,GAA4B,CAA/C;AAPJ;AAAA;AAAA;AAnCJ,eADF;AAmDD,aApDA,CADH;AAuDGoB,qBAASpB,MAAT,KAAoB,CAApB,IACC;AAAA;AAAA;AACGoB,uBAASiB,GAAT,CAAa,UAAUK,CAAV,EAAajD,CAAb,EAAgB;AAC5B,uBACE;AAAA;AAAA,oBAAI,WAAU,cAAd,EAA6B,iBAAeA,CAA5C,EAAiD,OAAO;AACtDmB,uCAAiBI,UAAUC,KAAV,CAAgBL,eADqB,EACJuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADjC;AAEtDC,kCAAYpC,UAAUC,KAAV,CAAgBoC,eAF0B,EAETC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFlB,qBAAxD;AAIGb;AAJH,iBADF;AAQD,eATA,CADH;AAWE;AAAA;AAAA,kBAAI,WAAU,eAAd;AACE,yBAAO;AACL9B,qCAAiBI,UAAUC,KAAV,CAAgBL,eAD5B,EAC6CuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADlF;AAELC,gCAAYpC,UAAUC,KAAV,CAAgBoC,eAFvB,EAEwCC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFnE,mBADT;AAKGrC,yBAASlB,MAAT,KAAoB,CAApB,GAAwB,QAAxB,GAAmC;AALtC;AAXF;AAxDJ,WAJF;AAkFE;AAAA;AAAA;AACGsB,oBAAQe,GAAR,CAAY,UAAUqB,MAAV,EAAkBjE,CAAlB,EAAqB;AAChC,kBAAMkE,kBAAkB3C,UAAUW,aAAV,CAAwB+B,MAAxB,EAAgC,EAAhC,CAAxB;AACA;AACA,kBAAIE,iBAAiB5C,UAAUC,KAAV,CAAgB4C,IAAhB,CAAqBC,MAArB,CAA4B;AAAA,uBAAKC,KAAK,YAAV;AAAA,eAA5B,CAArB;AACA,kBAAIC,uBAAuBJ,eAAe5D,MAA1C;AACA,kBAAIiE,UAAUjD,UAAUC,KAAV,CAAgBI,IAAhB,CAAqByC,MAArB,CAA4B;AAAA,uBAAKC,MAAM,SAAX;AAAA,eAA5B,CAAd;AACA,kBAAIG,WAAW,CAAf;AACA,kBAAID,QAAQjE,MAAR,GAAiB,CAArB,EAAwB;AACtB,oBAAImE,aAAaP,eAAeE,MAAf,CAAsB;AAAA,yBAAWJ,OAAOU,QAAP,CAAgBC,OAAhB,CAAX;AAAA,iBAAtB,CAAjB;AACA,oBAAIF,WAAWnE,MAAX,GAAoB,CAAxB,EAA2B;AACzBkE,6BAAYN,eAAeU,OAAf,CAAuBH,WAAW,CAAX,CAAvB,IAAwC,CAAzC,GAA8C,CAA9C,GAAkDP,eAAeU,OAAf,CAAuBH,WAAW,CAAX,CAAvB,CAA7D;AACD;AACF;AACD,qBACE;AAAA;AAAA,kBAAI,mBAAiB1E,CAArB;AACGiE,uBAAOrB,GAAP,CAAW,UAAUkC,GAAV,EAAe7E,CAAf,EAAkB;AAC5B,sBAAMC,IAAIJ,SAAS+B,OAAT,EAAkB7B,CAAlB,EAAqBC,CAArB,CAAV;AACA,sBAAIC,MAAM,CAAC,CAAX,EAAc;AACZ,2BAAO,IAAP;AACD;AACD,yBACE;AAAA;AAAA;AACE,2CAAmBF,CAAnB,SAAwBC,CAD1B;AAEE,iCAAU,aAFZ;AAGE,6BAAO;AACLkB,yCAAiBI,UAAUC,KAAV,CAAgBL,eAD5B,EAC6CuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADlF;AAELC,oCAAYpC,UAAUC,KAAV,CAAgBoC,eAFvB,EAEwCC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFnE,uBAHT;AAOE,+BAAS5D,CAPX;AAQE,+BACED,MAAM0B,SAASpB,MAAT,GAAkB,CAAxB,IAA6BkB,SAASlB,MAAT,KAAoB,CAAjD,GACI,CADJ,GAEI;AAXR;AAcGuE;AAdH,mBADF;AAkBD,iBAvBA,CADH;AAyBG/C,wBAAQa,GAAR,CAAY,UAAUmB,MAAV,EAAkB9D,CAAlB,EAAqB;AAChC,sBAAM8E,aAAaxD,UAAUW,aAAV,CAAwB+B,MAAxB,EAAgCF,MAAhC,CAAnB;AACA;AACA,sBAAII,iBAAiB5C,UAAUC,KAAV,CAAgB4C,IAAhB,CAAqBC,MAArB,CAA4B;AAAA,2BAAKC,KAAK,YAAV;AAAA,mBAA5B,CAArB;AACD;AACC,sBAAIU,UAAUzD,UAAUC,KAAV,CAAgBE,IAAhB,CAAqB2C,MAArB,CAA4B;AAAA,2BAAKC,MAAM,SAAX;AAAA,mBAA5B,CAAd;AACA,sBAAIE,UAAUjD,UAAUC,KAAV,CAAgBI,IAAhB,CAAqByC,MAArB,CAA4B;AAAA,2BAAKC,MAAM,SAAX;AAAA,mBAA5B,CAAd;AACA,sBAAIG,WAAW,CAAf;AACA,sBAAIO,QAAQzE,MAAR,GAAiB,CAArB,EAAwB;AACtB,wBAAImE,cAAaP,eAAeE,MAAf,CAAsB;AAAA,6BAAWN,OAAOY,QAAP,CAAgBC,OAAhB,CAAX;AAAA,qBAAtB,CAAjB;AACA,wBAAIF,YAAWnE,MAAX,GAAoB,CAAxB,EAA2B;AACzBkE,iCAAYN,eAAeU,OAAf,CAAuBH,YAAW,CAAX,CAAvB,IAAwC,CAAzC,GAA8C,CAA9C,GAAkDP,eAAeU,OAAf,CAAuBH,YAAW,CAAX,CAAvB,CAA7D;AACD;AACF,mBALD,MAKO,IAAIF,QAAQjE,MAAR,GAAiB,CAArB,EAAwB;AAC7B,wBAAImE,eAAaP,eAAeE,MAAf,CAAsB;AAAA,6BAAWJ,OAAOU,QAAP,CAAgBC,OAAhB,CAAX;AAAA,qBAAtB,CAAjB;AACA,wBAAIF,aAAWnE,MAAX,GAAoB,CAAxB,EAA2B;AACzBkE,iCAAYN,eAAeU,OAAf,CAAuBH,aAAW,CAAX,CAAvB,IAAwC,CAAzC,GAA8C,CAA9C,GAAkDP,eAAeU,OAAf,CAAuBH,aAAW,CAAX,CAAvB,CAA7D;AACD;AACF;AACD,yBACE;AAAA;AAAA;AACE,iCAAU,QADZ;AAEE,sCAAc1E,CAAd,SAAmBC,CAFrB;AAGE,6BAAO,iBAAEgF,KAAF,CAAQ5C,gBAAgB4B,MAAhB,EAAwBF,MAAxB,EAAgCgB,WAAWlC,KAAX,EAAhC,CAAR,EACL,EAAEc,YAAYpC,UAAUC,KAAV,CAAgB0D,cAA9B,EADK,EAC2C,EAAErB,WAAWtC,UAAUC,KAAV,CAAgB2D,aAA7B,EAD3C,EACyF,EAACC,OAAO7D,UAAU8D,cAAV,CAAyBpB,MAAzB,EAAiCF,MAAjC,CAAR,EADzF;AAHT;AAMIxC,8BAAUC,KAAV,CAAgB8D,cAAhB,IAAkC,IAAnC,GACC/D,UAAUC,KAAV,CAAgB8D,cAAhB,CAA+Bb,QAA/B,EAAyCM,WAAWlC,KAAX,EAAzC,CADD,GAECkC,WAAWQ,MAAX,CAAkBR,WAAWlC,KAAX,EAAlB;AARJ,mBADF;AAaD,iBAhCA,CAzBH;AA0DItB,0BAAUC,KAAV,CAAgBW,YAAjB,GAAiC,IAAjC;AACD;AACA;AAAA;AAAA;AACE,+BAAU,UADZ;AAEE,2BAAO,iBAAE8C,KAAF,CAAQ1C,eAAe2B,gBAAgBrB,KAAhB,EAAf,CAAR,EACL,EAAEc,YAAYpC,UAAUC,KAAV,CAAgB0D,cAA9B,EADK,EAC2C,EAAErB,WAAWtC,UAAUC,KAAV,CAAgB2D,aAA7B,EAD3C,EACyF,EAACC,OAAO7D,UAAUC,KAAV,CAAgBgE,cAAxB,EADzF;AAFT;AAKIjE,4BAAUC,KAAV,CAAgB8D,cAAhB,IAAkC,IAAnC,GACC/D,UAAUC,KAAV,CAAgB8D,cAAhB,CAA+Bf,oBAA/B,EAAqDL,gBAAgBrB,KAAhB,EAArD,CADD,GAECqB,gBAAgBqB,MAAhB,CAAuBrB,gBAAgBrB,KAAhB,EAAvB;AAPJ;AA5DF,eADF;AAyED,aAtFA,CADH;AAyFE;AAAA;AAAA;AACItB,wBAAUC,KAAV,CAAgBY,YAAjB,GAAiC,IAAjC,GACD;AAAA;AAAA;AACE,yBAAO;AACLjB,qCAAiBI,UAAUC,KAAV,CAAgBL,eAD5B,EAC6CuC,UAAUnC,UAAUC,KAAV,CAAgBkC,QAAhB,GAA2B,IADlF;AAELC,gCAAYpC,UAAUC,KAAV,CAAgBoC,eAFvB,EAEwCC,WAAWtC,UAAUC,KAAV,CAAgBsC;AAFnE,mBADT;AAKE,6BAAU,eALZ;AAME,2BAASnC,SAASpB,MAAT,IAAmBkB,SAASlB,MAAT,KAAoB,CAApB,GAAwB,CAAxB,GAA4B,CAA/C;AANX;AAAA;AAAA,eAFF;AAaGwB,sBAAQa,GAAR,CAAY,UAAUmB,MAAV,EAAkB/D,CAAlB,EAAqB;AAChC,oBAAMkE,kBAAkB3C,UAAUW,aAAV,CAAwB,EAAxB,EAA4B6B,MAA5B,CAAxB;AACA;AACA,oBAAII,iBAAiB5C,UAAUC,KAAV,CAAgB4C,IAAhB,CAAqBC,MAArB,CAA4B;AAAA,yBAAKC,KAAK,YAAV;AAAA,iBAA5B,CAArB;AACA,oBAAIC,uBAAuBJ,eAAe5D,MAA1C;AACA,oBAAIyE,UAAUzD,UAAUC,KAAV,CAAgBE,IAAhB,CAAqB2C,MAArB,CAA4B;AAAA,yBAAKC,MAAM,SAAX;AAAA,iBAA5B,CAAd;AACA,oBAAIG,WAAW,CAAf;AACA,oBAAIO,QAAQzE,MAAR,GAAiB,CAArB,EAAwB;AACtB,sBAAImE,aAAaP,eAAeE,MAAf,CAAsB;AAAA,2BAAWN,OAAOY,QAAP,CAAgBC,OAAhB,CAAX;AAAA,mBAAtB,CAAjB;AACA,sBAAIF,WAAWnE,MAAX,GAAoB,CAAxB,EAA2B;AACzBkE,+BAAYN,eAAeU,OAAf,CAAuBH,WAAW,CAAX,CAAvB,IAAwC,CAAzC,GAA8C,CAA9C,GAAkDP,eAAeU,OAAf,CAAuBH,WAAW,CAAX,CAAvB,CAA7D;AACD;AACF;AACD;AACA,uBACE;AAAA;AAAA;AACE,+BAAU,UADZ;AAEE,mCAAa1E,CAFf;AAGE,2BAAO,iBAAEiF,KAAF,CAAQ3C,eAAe4B,gBAAgBrB,KAAhB,EAAf,CAAR,EAAiD,EAACc,YAAYpC,UAAUC,KAAV,CAAgB0D,cAA7B,EAAjD,EACP,EAACrB,WAAWtC,UAAUC,KAAV,CAAgB2D,aAA5B,EADO,EACqC,EAACnB,SAAS5B,YAAV,EADrC,EAC8D,EAACgD,OAAO7D,UAAUC,KAAV,CAAgBgE,cAAxB,EAD9D;AAHT;AAMIjE,4BAAUC,KAAV,CAAgB8D,cAAhB,IAAkC,IAAnC,GACC/D,UAAUC,KAAV,CAAgB8D,cAAhB,CAA+Bf,uBAAuB,CAAtD,EAAyDL,gBAAgBrB,KAAhB,EAAzD,CADD,GAECqB,gBAAgBqB,MAAhB,CAAuBrB,gBAAgBrB,KAAhB,EAAvB;AARJ,iBADF;AAaD,eA3BA,CAbH;AAyCItB,wBAAUC,KAAV,CAAgBW,YAAhB,IAAgCZ,UAAUC,KAAV,CAAgBY,YAAjD,GAAiE,IAAjE,GACD;AAAA;AAAA,kBAAI,WAAU,eAAd,EAA8B,OAAO,EAAEuB,YAAYpC,UAAUC,KAAV,CAAgB0D,cAA9B,EAA8CrB,WAAWtC,UAAUC,KAAV,CAAgB2D,aAAzE,EAAwFC,OAAO7D,UAAUC,KAAV,CAAgBgE,cAA/G,EAArC;AACIjE,0BAAUC,KAAV,CAAgB8D,cAAhB,IAAkC,IAAnC,GACG/D,UAAUC,KAAV,CAAgB8D,cAAhB,CAA+Bf,uBAAuB,CAAtD,EAAyDtC,qBAAqBY,KAArB,EAAzD,CADH,GAEGZ,qBAAqBsD,MAArB,CAA4BtD,qBAAqBY,KAArB,EAA5B;AAHN;AA1CF;AAzFF;AAlFF,SADF;AAgOD;AAzR4B;;AAAA;AAAA,IACH,gBAAM4C,aADH;;AA4R/BnE,gBAAcoE,YAAd,GAA6B,qBAAUA,YAAvC;AACApE,gBAAcqE,SAAd,GAA0B,qBAAUA,SAApC;AACArE,gBAAcoE,YAAd,CAA2BhD,wBAA3B,GAAsD/B,sBAAtD;AACAW,gBAAcqE,SAAd,CAAwBjD,wBAAxB,GAAmD,oBAAUkD,IAA7D;AACA,SAAOtE,aAAP;AACD;;IAEKuE,iB;;;;;;;;;;;6BACK;AACP,UAAMtE,YAAY,yBAAc,KAAKC,KAAnB,CAAlB;AACA,UAAMK,UAAUN,UAAUO,UAAV,EAAhB;AACA,UAAMC,UAAUR,UAAUS,UAAV,EAAhB;AACA,UAAIH,QAAQtB,MAAR,KAAmB,CAAvB,EAA0B;AACxBsB,gBAAQmB,IAAR,CAAa,EAAb;AACD;AACD,UAAIjB,QAAQxB,MAAR,KAAmB,CAAvB,EAA0B;AACxBwB,gBAAQiB,IAAR,CAAa,EAAb;AACD;;AAED,UAAM8C,YAAYvE,UAAUC,KAAV,CAAgBI,IAAhB,CAAqBgB,GAArB,CAAyB;AAAA,eAAKK,CAAL;AAAA,OAAzB,CAAlB;AACA,UAAIlB,QAAQxB,MAAR,KAAmB,CAAnB,IAAwBwB,QAAQ,CAAR,EAAWxB,MAAX,KAAsB,CAAlD,EAAqD;AACnDuF,kBAAU9C,IAAV,CAAe,KAAKxB,KAAL,CAAWuE,cAA1B;AACD,OAFD,MAEO;AACLhE,gBAAQa,GAAR,CAAY;AAAA,iBAAKkD,UAAU9C,IAAV,CAAeE,EAAE8C,IAAF,CAAO,GAAP,CAAf,CAAL;AAAA,SAAZ;AACD;;AAED,UAAMC,SAASpE,QAAQe,GAAR,CAAY,aAAK;AAC9B,YAAMsD,MAAMjD,EAAEL,GAAF,CAAM;AAAA,iBAAK1C,CAAL;AAAA,SAAN,CAAZ;AACA6B,gBAAQa,GAAR,CAAY,aAAK;AACf,cAAMQ,IAAI7B,UAAUW,aAAV,CAAwBe,CAAxB,EAA2BC,CAA3B,EAA8BL,KAA9B,EAAV;AACAqD,cAAIlD,IAAJ,CAASI,IAAIA,CAAJ,GAAQ,EAAjB;AACD,SAHD;AAIA,eAAO8C,GAAP;AACD,OAPc,CAAf;;AASAD,aAAOE,OAAP,CAAeL,SAAf;;AAEA,aACE;AACE,eAAOG,OAAOrD,GAAP,CAAW;AAAA,iBAAKK,EAAE+C,IAAF,CAAO,IAAP,CAAL;AAAA,SAAX,EAA8BA,IAA9B,CAAmC,IAAnC,CADT;AAEE,eAAO,EAAEI,OAAOC,OAAOC,UAAP,GAAoB,CAA7B,EAAgCC,QAAQF,OAAOG,WAAP,GAAqB,CAA7D,EAFT;AAGE,kBAAU;AAHZ,QADF;AAOD;;;;EArC6B,gBAAMf,a;;AAwCtCI,kBAAkBH,YAAlB,GAAiC,qBAAUA,YAA3C;AACAG,kBAAkBF,SAAlB,GAA8B,qBAAUA,SAAxC;;kBAEe;AACbc,SAAOrF,cADM;AAEb,mBAAiBA,aAAa,EAAEoB,aAAa,MAAf,EAAb,CAFJ;AAGb,uBAAqBpB,aAAa,EAAEoB,aAAa,KAAf,EAAb,CAHR;AAIb,uBAAqBpB,aAAa,EAAEoB,aAAa,KAAf,EAAb,CAJR;AAKb,oBAAkBqD;AALL,C","file":"TableRenderers.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { PivotData } from './Utilities';\nimport _ from 'lodash';\n\n// helper function for setting row/col-span in pivotTableRenderer\nconst spanSize = function (arr, i, j) {\n  let x;\n  if (i !== 0) {\n    let asc, end;\n    let noDraw = true;\n    for (\n      x = 0, end = j, asc = end >= 0;\n      asc ? x <= end : x >= end;\n      asc ? x++ : x--\n    ) {\n      if (arr[i - 1][x] !== arr[i][x]) {\n        noDraw = false;\n      }\n    }\n    if (noDraw) {\n      return -1;\n    }\n  }\n  let len = 0;\n  while (i + len < arr.length) {\n    let asc1, end1;\n    let stop = false;\n    for (\n      x = 0, end1 = j, asc1 = end1 >= 0;\n      asc1 ? x <= end1 : x >= end1;\n      asc1 ? x++ : x--\n    ) {\n      if (arr[i][x] !== arr[i + len][x]) {\n        stop = true;\n      }\n    }\n    if (stop) {\n      break;\n    }\n    len++;\n  }\n  return len;\n};\n\nfunction redColorScaleGenerator(values) {\n  const min = Math.min.apply(Math, values);\n  const max = Math.max.apply(Math, values);\n  return x => {\n    // eslint-disable-next-line no-magic-numbers\n    const nonRed = 255 - Math.round(255 * (x - min) / (max - min));\n    return { backgroundColor: `rgb(255,${nonRed},${nonRed})` };\n  };\n}\n\nfunction makeRenderer(opts = {}) {\n  class TableRenderer extends React.PureComponent {\n    render() {\n      const pivotData = new PivotData(this.props);\n      const colAttrs = pivotData.props.cols;\n      const rowAttrs = pivotData.props.rows;\n      const rowKeys = pivotData.getRowKeys();\n      const colKeys = pivotData.getColKeys();\n      const grandTotalAggregator = pivotData.getAggregator([], []);\n      \n      let hideRowTotal = (pivotData.props.hideRowTotal) ? \"none\" : \"table-cell\";\n      let hideColTotal = (pivotData.props.hideColTotal) ? \"none\" : \"table-cell\";\n      \n      let valueCellColors = () => { };\n      let rowTotalColors = () => { };\n      let colTotalColors = () => { };\n      if (opts.heatmapMode) {\n        const colorScaleGenerator = this.props.tableColorScaleGenerator;\n        const rowTotalValues = colKeys.map(x =>\n          pivotData.getAggregator([], x).value()\n        );\n        rowTotalColors = colorScaleGenerator(rowTotalValues);\n        const colTotalValues = rowKeys.map(x =>\n          pivotData.getAggregator(x, []).value()\n        );\n        colTotalColors = colorScaleGenerator(colTotalValues);\n\n        if (opts.heatmapMode === 'full') {\n          const allValues = [];\n          rowKeys.map(r =>\n            colKeys.map(c =>\n              allValues.push(pivotData.getAggregator(r, c).value())\n            )\n          );\n          const colorScale = colorScaleGenerator(allValues);\n          valueCellColors = (r, c, v) => colorScale(v);\n        } else if (opts.heatmapMode === 'row') {\n          const rowColorScales = {};\n          rowKeys.map(r => {\n            const rowValues = colKeys.map(x =>\n              pivotData.getAggregator(r, x).value()\n            );\n            rowColorScales[r] = colorScaleGenerator(rowValues);\n          });\n          valueCellColors = (r, c, v) => rowColorScales[r](v);\n        } else if (opts.heatmapMode === 'col') {\n          const colColorScales = {};\n          colKeys.map(c => {\n            const colValues = rowKeys.map(x =>\n              pivotData.getAggregator(x, c).value()\n            );\n            colColorScales[c] = colorScaleGenerator(colValues);\n          });\n          valueCellColors = (r, c, v) => colColorScales[c](v);\n        }\n      }\n\n      return (\n        <table className=\"pvtTable\"\n          style={{\n            fontFamily: pivotData.props.fontFamily, fontSize: pivotData.props.fontSize + \"pt\"\n          }}>\n          <thead>\n            {colAttrs.map(function (c, j) {\n              return (\n                <tr key={`colAttr${j}`}>\n                  {j === 0 &&\n                    rowAttrs.length !== 0 && (\n                      <th style={{ backgroundColor: pivotData.props.backgroundColor }} colSpan={rowAttrs.length} rowSpan={colAttrs.length} />\n                    )}\n                  <th className=\"pvtAxisLabel\" style={{\n                    backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                    fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                  }}>{c}</th>\n                  {colKeys.map(function (colKey, i) {\n                    const x = spanSize(colKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        className=\"pvtColLabel\"\n                        style={{\n                          backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                          fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                        }}\n                        key={`colKey${i}`}\n                        colSpan={x}\n                        rowSpan={\n                          j === colAttrs.length - 1 && rowAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {colKey[j]}\n                      </th>\n                    );\n                  })}\n\n                  {j === 0 && (\n                    <th\n                      className=\"pvtTotalLabel\"\n                      style={{\n                        backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                        fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle, display: hideRowTotal\n                      }}\n                      rowSpan={\n                        colAttrs.length + (rowAttrs.length === 0 ? 0 : 1)\n                      }\n                    >\n                      Totals\n                    </th>\n                  )}\n                </tr>\n              );\n            })}\n\n            {rowAttrs.length !== 0 && (\n              <tr>\n                {rowAttrs.map(function (r, i) {\n                  return (\n                    <th className=\"pvtAxisLabel\" key={`rowAttr${i}`} style={{\n                      backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                      fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                    }}>\n                      {r}\n                    </th>\n                  );\n                })}\n                <th className=\"pvtTotalLabel\"\n                  style={{\n                    backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                    fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                  }}>\n                  {colAttrs.length === 0 ? 'Totals' : null}\n                </th>\n              </tr>\n            )}\n          </thead>\n\n          <tbody>\n            {rowKeys.map(function (rowKey, i) {\n              const totalAggregator = pivotData.getAggregator(rowKey, []);\n              // To find Index of Measure\n              let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n              let totalFormattingIndex = getAllMeasures.length;\n              let findRow = pivotData.props.rows.filter(d => d === \"Measure\");\n              let getIndex = 0;\n              if (findRow.length > 0) {\n                let getElement = getAllMeasures.filter(element => rowKey.includes(element));\n                if (getElement.length > 0) {\n                  getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                }\n              }\n              return (\n                <tr key={`rowKeyRow${i}`}>\n                  {rowKey.map(function (txt, j) {\n                    const x = spanSize(rowKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        key={`rowKeyLabel${i}-${j}`}\n                        className=\"pvtRowLabel\"\n                        style={{\n                          backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                          fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                        }}\n                        rowSpan={x}\n                        colSpan={\n                          j === rowAttrs.length - 1 && colAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {txt}\n                      </th>\n                    );\n                  })}\n                  {colKeys.map(function (colKey, j) {\n                    const aggregator = pivotData.getAggregator(rowKey, colKey);\n                    // To find Index of Measure\n                    let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n                   // let totalFormattingIndex = getAllMeasures.length;\n                    let findCol = pivotData.props.cols.filter(d => d === \"Measure\");\n                    let findRow = pivotData.props.rows.filter(d => d === \"Measure\");\n                    let getIndex = 0;\n                    if (findCol.length > 0) {\n                      let getElement = getAllMeasures.filter(element => colKey.includes(element));\n                      if (getElement.length > 0) {\n                        getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                      }\n                    } else if (findRow.length > 0) {\n                      let getElement = getAllMeasures.filter(element => rowKey.includes(element));\n                      if (getElement.length > 0) {\n                        getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                      }\n                    }\n                    return (\n                      <td\n                        className=\"pvtVal\"\n                        key={`pvtVal${i}-${j}`}\n                        style={_.merge(valueCellColors(rowKey, colKey, aggregator.value()),\n                          { fontWeight: pivotData.props.fontDataWeight }, { fontStyle: pivotData.props.fontDataStyle }, {color: pivotData.ValueFontColor(rowKey, colKey)})}\n                      >\n                        {(pivotData.props.valueFormatter != null) ?\n                          pivotData.props.valueFormatter[getIndex](aggregator.value()) :\n                          aggregator.format(aggregator.value())\n                        }\n                      </td>\n                    );\n                  })}\n                  {(pivotData.props.hideRowTotal) ? null :\n                  // Row Formatting\n                  <td\n                    className=\"pvtTotal\"\n                    style={_.merge(colTotalColors(totalAggregator.value()),\n                      { fontWeight: pivotData.props.fontDataWeight }, { fontStyle: pivotData.props.fontDataStyle }, {color: pivotData.props.totalfontColor})}\n                  >\n                    {(pivotData.props.valueFormatter != null) ?\n                      pivotData.props.valueFormatter[totalFormattingIndex](totalAggregator.value()) :\n                      totalAggregator.format(totalAggregator.value())\n                    }\n                  </td>}\n                </tr>\n              );\n            })}\n\n            <tr>\n              {(pivotData.props.hideColTotal) ? null :\n              <th\n                style={{\n                  backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\",\n                  fontWeight: pivotData.props.fontLabelWeight, fontStyle: pivotData.props.fontLabelStyle\n                }}\n                className=\"pvtTotalLabel\"\n                colSpan={rowAttrs.length + (colAttrs.length === 0 ? 0 : 1)}\n              >\n                Totals\n              </th>}\n\n              {colKeys.map(function (colKey, i) {\n                const totalAggregator = pivotData.getAggregator([], colKey);\n                // To find Index of Measure\n                let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n                let totalFormattingIndex = getAllMeasures.length;\n                let findCol = pivotData.props.cols.filter(d => d === \"Measure\");\n                let getIndex = 0;\n                if (findCol.length > 0) {\n                  let getElement = getAllMeasures.filter(element => colKey.includes(element));\n                  if (getElement.length > 0) {\n                    getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                  }\n                }\n                // Column Total Formatting\n                return (\n                  <td\n                    className=\"pvtTotal\"\n                    key={`total${i}`}\n                    style={_.merge(rowTotalColors(totalAggregator.value()), {fontWeight: pivotData.props.fontDataWeight}, \n                    {fontStyle: pivotData.props.fontDataStyle}, {display: hideColTotal}, {color: pivotData.props.totalfontColor})}\n                  >\n                    {(pivotData.props.valueFormatter != null) ?\n                      pivotData.props.valueFormatter[totalFormattingIndex + 1](totalAggregator.value()) :\n                      totalAggregator.format(totalAggregator.value())\n                    }\n                  </td>\n                );\n              })}\n              {(pivotData.props.hideRowTotal || pivotData.props.hideColTotal) ? null :\n              <td className=\"pvtGrandTotal\" style={{ fontWeight: pivotData.props.fontDataWeight, fontStyle: pivotData.props.fontDataStyle, color: pivotData.props.totalfontColor }}>\n                {(pivotData.props.valueFormatter != null) ?\n                    pivotData.props.valueFormatter[totalFormattingIndex + 2](grandTotalAggregator.value()) :\n                    grandTotalAggregator.format(grandTotalAggregator.value())\n                }\n              </td> }\n            </tr>\n          </tbody>\n        </table>\n      );\n    }\n  }\n\n  TableRenderer.defaultProps = PivotData.defaultProps;\n  TableRenderer.propTypes = PivotData.propTypes;\n  TableRenderer.defaultProps.tableColorScaleGenerator = redColorScaleGenerator;\n  TableRenderer.propTypes.tableColorScaleGenerator = PropTypes.func;\n  return TableRenderer;\n}\n\nclass TSVExportRenderer extends React.PureComponent {\n  render() {\n    const pivotData = new PivotData(this.props);\n    const rowKeys = pivotData.getRowKeys();\n    const colKeys = pivotData.getColKeys();\n    if (rowKeys.length === 0) {\n      rowKeys.push([]);\n    }\n    if (colKeys.length === 0) {\n      colKeys.push([]);\n    }\n\n    const headerRow = pivotData.props.rows.map(r => r);\n    if (colKeys.length === 1 && colKeys[0].length === 0) {\n      headerRow.push(this.props.aggregatorName);\n    } else {\n      colKeys.map(c => headerRow.push(c.join('-')));\n    }\n\n    const result = rowKeys.map(r => {\n      const row = r.map(x => x);\n      colKeys.map(c => {\n        const v = pivotData.getAggregator(r, c).value();\n        row.push(v ? v : '');\n      });\n      return row;\n    });\n\n    result.unshift(headerRow);\n\n    return (\n      <textarea\n        value={result.map(r => r.join('\\t')).join('\\n')}\n        style={{ width: window.innerWidth / 2, height: window.innerHeight / 2 }}\n        readOnly={true}\n      />\n    );\n  }\n}\n\nTSVExportRenderer.defaultProps = PivotData.defaultProps;\nTSVExportRenderer.propTypes = PivotData.propTypes;\n\nexport default {\n  Table: makeRenderer(),\n  'Table Heatmap': makeRenderer({ heatmapMode: 'full' }),\n  'Table Col Heatmap': makeRenderer({ heatmapMode: 'col' }),\n  'Table Row Heatmap': makeRenderer({ heatmapMode: 'row' }),\n  'Exportable TSV': TSVExportRenderer,\n};\n"]}