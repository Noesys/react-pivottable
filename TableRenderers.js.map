{"version":3,"sources":["src/TableRenderers.jsx"],"names":["spanSize","arr","i","j","x","asc","end","noDraw","len","length","asc1","end1","stop","redColorScaleGenerator","values","min","Math","apply","max","nonRed","round","backgroundColor","makeRenderer","opts","TableRenderer","pivotData","props","colAttrs","cols","rowAttrs","rows","rowKeys","getRowKeys","colKeys","getColKeys","grandTotalAggregator","getAggregator","valueCellColors","rowTotalColors","colTotalColors","heatmapMode","colorScaleGenerator","tableColorScaleGenerator","rowTotalValues","map","value","colTotalValues","allValues","push","r","c","colorScale","v","rowColorScales","rowValues","colColorScales","colValues","fontFamily","fontSize","fontStyle","fontWeight","colKey","rowKey","totalAggregator","getAllMeasures","vals","filter","d","findRow","getIndex","getElement","includes","element","indexOf","txt","aggregator","findCol","valueFormatter","format","PureComponent","defaultProps","propTypes","func","TSVExportRenderer","headerRow","aggregatorName","join","result","row","unshift","width","window","innerWidth","height","innerHeight","Table"],"mappings":"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","file":"TableRenderers.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport {PivotData} from './Utilities';\n\n// helper function for setting row/col-span in pivotTableRenderer\nconst spanSize = function(arr, i, j) {\n  let x;\n  if (i !== 0) {\n    let asc, end;\n    let noDraw = true;\n    for (\n      x = 0, end = j, asc = end >= 0;\n      asc ? x <= end : x >= end;\n      asc ? x++ : x--\n    ) {\n      if (arr[i - 1][x] !== arr[i][x]) {\n        noDraw = false;\n      }\n    }\n    if (noDraw) {\n      return -1;\n    }\n  }\n  let len = 0;\n  while (i + len < arr.length) {\n    let asc1, end1;\n    let stop = false;\n    for (\n      x = 0, end1 = j, asc1 = end1 >= 0;\n      asc1 ? x <= end1 : x >= end1;\n      asc1 ? x++ : x--\n    ) {\n      if (arr[i][x] !== arr[i + len][x]) {\n        stop = true;\n      }\n    }\n    if (stop) {\n      break;\n    }\n    len++;\n  }\n  return len;\n};\n\nfunction redColorScaleGenerator(values) {\n  const min = Math.min.apply(Math, values);\n  const max = Math.max.apply(Math, values);\n  return x => {\n    // eslint-disable-next-line no-magic-numbers\n    const nonRed = 255 - Math.round(255 * (x - min) / (max - min));\n    return {backgroundColor: `rgb(255,${nonRed},${nonRed})`};\n  };\n}\n\nfunction makeRenderer(opts = {}) {\n  class TableRenderer extends React.PureComponent {\n    render() {\n      const pivotData = new PivotData(this.props);\n      const colAttrs = pivotData.props.cols;\n      const rowAttrs = pivotData.props.rows;\n      const rowKeys = pivotData.getRowKeys();\n      const colKeys = pivotData.getColKeys();\n      const grandTotalAggregator = pivotData.getAggregator([], []);\n\n      let valueCellColors = () => {};\n      let rowTotalColors = () => {};\n      let colTotalColors = () => {};\n      if (opts.heatmapMode) {\n        const colorScaleGenerator = this.props.tableColorScaleGenerator;\n        const rowTotalValues = colKeys.map(x =>\n          pivotData.getAggregator([], x).value()\n        );\n        rowTotalColors = colorScaleGenerator(rowTotalValues);\n        const colTotalValues = rowKeys.map(x =>\n          pivotData.getAggregator(x, []).value()\n        );\n        colTotalColors = colorScaleGenerator(colTotalValues);\n\n        if (opts.heatmapMode === 'full') {\n          const allValues = [];\n          rowKeys.map(r =>\n            colKeys.map(c =>\n              allValues.push(pivotData.getAggregator(r, c).value())\n            )\n          );\n          const colorScale = colorScaleGenerator(allValues);\n          valueCellColors = (r, c, v) => colorScale(v);\n        } else if (opts.heatmapMode === 'row') {\n          const rowColorScales = {};\n          rowKeys.map(r => {\n            const rowValues = colKeys.map(x =>\n              pivotData.getAggregator(r, x).value()\n            );\n            rowColorScales[r] = colorScaleGenerator(rowValues);\n          });\n          valueCellColors = (r, c, v) => rowColorScales[r](v);\n        } else if (opts.heatmapMode === 'col') {\n          const colColorScales = {};\n          colKeys.map(c => {\n            const colValues = rowKeys.map(x =>\n              pivotData.getAggregator(x, c).value()\n            );\n            colColorScales[c] = colorScaleGenerator(colValues);\n          });\n          valueCellColors = (r, c, v) => colColorScales[c](v);\n        }\n      }\n\n      return (\n        <table className=\"pvtTable\" \n          style={{\n            fontFamily: pivotData.props.fontFamily, fontSize: pivotData.props.fontSize + \"pt\",\n            fontStyle: pivotData.props.fontStyle, fontWeight: pivotData.props.fontWeight\n          }}>\n          <thead>\n            {colAttrs.map(function(c, j) {\n              return (\n                <tr key={`colAttr${j}`}>\n                  {j === 0 &&\n                    rowAttrs.length !== 0 && (\n                      <th style={{backgroundColor: pivotData.props.backgroundColor}} colSpan={rowAttrs.length} rowSpan={colAttrs.length} />\n                    )}\n                  <th className=\"pvtAxisLabel\" style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}>{c}</th>\n                  {colKeys.map(function(colKey, i) {\n                    const x = spanSize(colKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        className=\"pvtColLabel\"\n                        style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}\n                        key={`colKey${i}`}\n                        colSpan={x}\n                        rowSpan={\n                          j === colAttrs.length - 1 && rowAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {colKey[j]}\n                      </th>\n                    );\n                  })}\n\n                  {j === 0 && (\n                    <th\n                      className=\"pvtTotalLabel\"\n                      style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}\n                      rowSpan={\n                        colAttrs.length + (rowAttrs.length === 0 ? 0 : 1)\n                      }\n                    >\n                      Totals\n                    </th>\n                  )}\n                </tr>\n              );\n            })}\n\n            {rowAttrs.length !== 0 && (\n              <tr>\n                {rowAttrs.map(function(r, i) {\n                  return (\n                    <th className=\"pvtAxisLabel\" key={`rowAttr${i}`} style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}>\n                      {r}\n                    </th>\n                  );\n                })}\n                <th className=\"pvtTotalLabel\"\n                  style={{ backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\" }}>\n                  {colAttrs.length === 0 ? 'Totals' : null}\n                </th>\n              </tr>\n            )}\n          </thead>\n\n          <tbody>\n            {rowKeys.map(function(rowKey, i) {\n              const totalAggregator = pivotData.getAggregator(rowKey, []);\n               // To find Index of Measure\n               let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n               let findRow = pivotData.props.rows.filter(d => d === \"Measure\");\n               let getIndex = 0;\n               if (findRow.length > 0) {\n                 let getElement = getAllMeasures.filter(element => rowKey.includes(element));\n                 if (getElement.length > 0) {\n                   getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                 }\n               }\n              return (\n                <tr key={`rowKeyRow${i}`}>\n                  {rowKey.map(function(txt, j) {\n                    const x = spanSize(rowKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        key={`rowKeyLabel${i}-${j}`}\n                        className=\"pvtRowLabel\"\n                        style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}\n                        rowSpan={x}\n                        colSpan={\n                          j === rowAttrs.length - 1 && colAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {txt}\n                      </th>\n                    );\n                  })}\n                  {colKeys.map(function(colKey, j) {\n                    const aggregator = pivotData.getAggregator(rowKey, colKey);\n                    // To find Index of Measure\n                    let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n                    let findCol = pivotData.props.cols.filter(d => d === \"Measure\");\n                    let findRow = pivotData.props.rows.filter(d => d === \"Measure\");\n                    let getIndex = 0;\n                    if (findCol.length > 0) {\n                      let getElement = getAllMeasures.filter(element => colKey.includes(element));\n                      if (getElement.length > 0) {\n                        getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                      }\n                    } else if (findRow.length > 0) {\n                      let getElement = getAllMeasures.filter(element => rowKey.includes(element));\n                      if (getElement.length > 0) {\n                        getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                      }\n                    }\n                    return (\n                      <td\n                        className=\"pvtVal\"\n                        key={`pvtVal${i}-${j}`}\n                        style={valueCellColors(\n                          rowKey,\n                          colKey,\n                          aggregator.value()\n                        )}\n                      >\n                        {(pivotData.props.valueFormatter != null) ?\n                          pivotData.props.valueFormatter[getIndex](aggregator.value()) :\n                          aggregator.format(aggregator.value())\n                        }\n                      </td>\n                    );\n                  })}\n                  <td\n                    className=\"pvtTotal\"\n                    style={colTotalColors(totalAggregator.value())}\n                  >\n                    {(pivotData.props.valueFormatter != null && findRow.length > 0) ?\n                      pivotData.props.valueFormatter[getIndex](totalAggregator.value()) :\n                      totalAggregator.format(totalAggregator.value())\n                    }\n                  </td>\n                </tr>\n              );\n            })}\n\n            <tr>\n              <th\n                style={{backgroundColor: pivotData.props.backgroundColor, fontSize: pivotData.props.fontSize + \"pt\"}}\n                className=\"pvtTotalLabel\"\n                colSpan={rowAttrs.length + (colAttrs.length === 0 ? 0 : 1)}\n              >\n                Totals\n              </th>\n\n              {colKeys.map(function(colKey, i) {\n                const totalAggregator = pivotData.getAggregator([], colKey);\n                // To find Index of Measure\n                let getAllMeasures = pivotData.props.vals.filter(d => d != \"MeasureVal\");\n                let findCol = pivotData.props.cols.filter(d => d === \"Measure\");\n                let getIndex = 0;\n                if (findCol.length > 0) {\n                  let getElement = getAllMeasures.filter(element => colKey.includes(element));\n                  if (getElement.length > 0) {\n                    getIndex = (getAllMeasures.indexOf(getElement[0]) < 0) ? 0 : getAllMeasures.indexOf(getElement[0]);\n                  }\n                }\n                return (\n                  <td\n                    className=\"pvtTotal\"\n                    key={`total${i}`}\n                    style={rowTotalColors(totalAggregator.value())}\n                  > \n                    {(pivotData.props.valueFormatter != null && findCol.length > 0) ?\n                      pivotData.props.valueFormatter[getIndex](totalAggregator.value()) :\n                      totalAggregator.format(totalAggregator.value())\n                    }\n                  </td>\n                );\n              })}\n\n              <td className=\"pvtGrandTotal\">\n                  { grandTotalAggregator.format(grandTotalAggregator.value()) }\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      );\n    }\n  }\n\n  TableRenderer.defaultProps = PivotData.defaultProps;\n  TableRenderer.propTypes = PivotData.propTypes;\n  TableRenderer.defaultProps.tableColorScaleGenerator = redColorScaleGenerator;\n  TableRenderer.propTypes.tableColorScaleGenerator = PropTypes.func;\n  return TableRenderer;\n}\n\nclass TSVExportRenderer extends React.PureComponent {\n  render() {\n    const pivotData = new PivotData(this.props);\n    const rowKeys = pivotData.getRowKeys();\n    const colKeys = pivotData.getColKeys();\n    if (rowKeys.length === 0) {\n      rowKeys.push([]);\n    }\n    if (colKeys.length === 0) {\n      colKeys.push([]);\n    }\n\n    const headerRow = pivotData.props.rows.map(r => r);\n    if (colKeys.length === 1 && colKeys[0].length === 0) {\n      headerRow.push(this.props.aggregatorName);\n    } else {\n      colKeys.map(c => headerRow.push(c.join('-')));\n    }\n\n    const result = rowKeys.map(r => {\n      const row = r.map(x => x);\n      colKeys.map(c => {\n        const v = pivotData.getAggregator(r, c).value();\n        row.push(v ? v : '');\n      });\n      return row;\n    });\n\n    result.unshift(headerRow);\n\n    return (\n      <textarea\n        value={result.map(r => r.join('\\t')).join('\\n')}\n        style={{width: window.innerWidth / 2, height: window.innerHeight / 2}}\n        readOnly={true}\n      />\n    );\n  }\n}\n\nTSVExportRenderer.defaultProps = PivotData.defaultProps;\nTSVExportRenderer.propTypes = PivotData.propTypes;\n\nexport default {\n  Table: makeRenderer(),\n  'Table Heatmap': makeRenderer({heatmapMode: 'full'}),\n  'Table Col Heatmap': makeRenderer({heatmapMode: 'col'}),\n  'Table Row Heatmap': makeRenderer({heatmapMode: 'row'}),\n  'Exportable TSV': TSVExportRenderer,\n};\n"]}